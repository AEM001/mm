# C题 NIPT的时点选择与胎儿的异常判定

NIPT（Non- invasivePrenatalTest，即无创产前检测）是一种通过采集母体血液、检测胎儿的游离DNA片段、分析胎儿染色体是否存在异常的产前检测技术，目的是通过早期检测确定胎儿的健康状况。根据临床经验，畸型胎儿主要有唐氏综合征、爱德华氏综合征和帕陶氏综合征，这三种体征分别由胎儿21号、18号和13号“染色体游离DNA片段的比例”（简称“染色体浓度”）是否异常决定。NIPT的准确性主要由胎儿性染色体（男胎XY，女胎XX）浓度判断。通常孕妇的孕期在10周\~25周之间可以检测胎儿性染色体浓度，且如果男胎的Y染色体浓度达到或高于  $4\%$  、女胎的X染色体浓度没有异常，则可认为NIPT的结果是基本准确的，否则难以保证结果准确性要求。同时，实际中应尽早发现不健康的胎儿，否则会带来治疗窗口期缩短的风险，早期发现（12周以内）风险较低；中期发现（13一27周）风险高；晚期发现（28周以后）风险极高。

实践表明，男胎Y染色体浓度与孕妇孕周数及其身体质量指数（BMI）紧密相关。通常根据孕妇的BMI值进行分组（例如：[20,28)，[28,32)，[32,36)，[36,40)，40以上）分别确定NIPT的时点（相对孕期的时间点)。由于每个孕妇的年龄、BMI、孕情等存在个体差异，对所有孕妇采用简单的经验分组和统一的检测时点进行NIPT，会对其准确性产生较大影响。因此，依据BMI对孕妇进行合理分组，确定各不同群组的最佳NIPT时点，可以减少某些孕妇因胎儿不健康而缩短治疗窗口期所带来的潜在风险。

为了研究各类孕妇群体合适的NIPT时点，并对检测的准确性进行分析，附件给出了某地区（大多为高BMI）孕妇的NIPT数据。在实际检测中，经常会出现测序失败（比如：检测时点过早和不确定因素影响等）的情况。同时为了增加检测结果的可靠性，对某些孕妇有多次采血多次检测或一次采血多次检测的情况。试利用附件提供的数据建立数学模型研究如下问题：

问题1试分析胎儿Y染色体浓度与孕妇的孕周数和BMI等指标的相关特性，给出相应的关系模型，并检验其显著性。（已经完成）

问题2临床证明，男胎孕妇的BMI是影响胎儿Y染色体浓度的最早达标时间（即浓度达到或超过  $4\%$  的最早时间)的主要因素。试对男胎孕妇的BMI进行合理分组，给出每组的BMI区间和最佳NIPT时点，使得孕妇可能的潜在风险最小，并分析检测误差对结果的影响。（目前解决）

问题3男胎Y染色体浓度达标时间受多种因素(身高、体重、年龄等)的影响，试综合考虑这些因素、检测误差和胎儿的Y染色体浓度达标比例（即浓度达到或超过  $4\%$  的比例)，根据男胎孕妇的BMI，给出合理分组以及每组的最佳NIPT时点，使得孕妇潜在风险最小，并分析检测误差对结果的影响。

问题4由于孕妇和女胎都不携带Y染色体，重要的是如何判定女胎是否异常。试以女胎孕妇的21号、18号和13号染色体非整倍体（AB列）为判定结果，综合考虑X染色体及上述染色体的Z值、GC含量、读段数及相关比例、BMI等因素，给出女胎异常的判定方法。

附录1 附件中各列数据的说明
原始附件数据结构：

```
python -c "import pandas as pd; df = pd.read_excel('/Users/Mac/Downloads/mm/附件.xlsx', sheet_name='男胎检测数据'); print('列名和索引:'); print([(i, col) for i, col in enumerate(df.columns)]); print('\n前几行数据:'); print(df.head()); print('\n每个孕妇的检测次数:'); print(df['孕妇代码'].value_counts().head(10))"
```

结果：

```
列名和索引:
[(0, '序号'), (1, '孕妇代码'), (2, '年龄'), (3, '身高'), (4, '体重'), (5, '末次月经'), (6, 'IVF妊娠'), (7, '检测日期'), (8, '检测抽血次数'), (9, '检测孕周'), (10, '孕妇BMI'), (11, '原始读段数'), (12, '在参考基因组上比对的比例'), (13, '重复读段的比例'), (14, '唯一比对的读段数  '), (15, 'GC含量'), (16, '13号染色体的Z值'), (17, '18号染色体的Z值'), (18, '21号染色体的Z值'), (19, 'X染色体的Z值'), (20, 'Y染色体的Z值'), (21, 'Y染色体浓度'), (22, 'X染色体浓度'), (23, '13号染色体的GC含量'), (24, '18号染色体的GC含量'), (25, '21号染色体的GC含量'), (26, '被过滤掉读段数的比例'), (27, '染色体的非整倍体'), (28, '怀孕次数'), (29, '生产次数'), (30, '胎儿是否健康')]

前几行数据:
   序号  孕妇代码  年龄     身高    体重  ... 被过滤掉读段数的比例 染色体的非整倍体 怀孕次数  生产次数 胎儿是否健康
0   1  A001  31  160.0  72.0  ...   0.027484      NaN    1     0      是
1   2  A001  31  160.0  73.0  ...   0.019617      NaN    1     0      是
2   3  A001  31  160.0  73.0  ...   0.022312      NaN    1     0      是
3   4  A001  31  160.0  74.0  ...   0.023280      NaN    1     0      是
4   5  A002  32  149.0  74.0  ...   0.024212      NaN    2     1      否

[5 rows x 31 columns]

每个孕妇的检测次数:
孕妇代码
A041    8
A155    8
A069    8
A091    7
A079    7
A029    7
A026    7
A010    7
A055    7
A027    6
Name: count, dtype: int64
Exit Code 0
```

# 附录2 Z值（Z-score）

Z值（Z- score）的计算公式：

$$
Z = \frac{X - \mu}{\sigma}
$$

其中  $X$  为待检测样本中目标染色体的相对计数比例，  $\mu$  为正常对照群体中该染色体计数比例的均值，  $\sigma$  为正常群体中该比例的标准差。在NIPT中，对于常见染色体非整倍体检测，通常采用  $Z$  值分析方法进行统计判定。已知染色体非整倍体通常定义为该染色体存在一个或三个拷贝，正常为两个拷贝，且每条染色体所采集到的读段数量与该染色体长度成正比。
