# 问题三（GAMM+KMeans）聚类驱动的检测误差分析报告

## 1. 分析概述

本报告基于**GAMM（广义加性混合模型）+KMeans聚类**的框架，分析NIPT检测过程中聚类特异性的测量误差及其对达标时间预测的影响。与传统的单一误差分析不同，本分析充分利用了BMI聚类分组的特征，实现了**聚类驱动的误差建模**。

### 1.1 问题三特色分析框架

- **聚类特异性噪声估计**：针对不同BMI聚类组分别分析噪声特征
- **组间差异统计检验**：评估不同聚类组噪声特征的显著性差异
- **GAMM驱动的误差传播**：基于GAMM预测结果进行误差传播分析
- **聚类稳定性评估**：分析噪声对聚类结果稳定性的影响

### 1.2 聚类分组设定

- 组别1: BMI(标准化)∈[-0.196, 0.522] | 中位达标时间≈16.6周
- 组别2: BMI(标准化)∈[-1.890, -0.660] | 中位达标时间≈17.1周
- 组别3: BMI(标准化)∈[1.325, 2.605] | 中位达标时间≈19.7周
- 组别4: BMI(标准化)∈[-1.218, -0.571] | 中位达标时间≈12.8周
- 组别5: BMI(标准化)∈[2.935, 4.845] | 中位达标时间≈17.6周
- 组别6: BMI(标准化)∈[0.096, 0.874] | 中位达标时间≈10.5周
- 组别7: BMI(标准化)∈[-0.894, -0.221] | 中位达标时间≈16.2周
- 组别8: BMI(标准化)∈[-3.857, -3.857] | 中位达标时间≈22.1周
- 组别9: BMI(标准化)∈[0.385, 1.312] | 中位达标时间≈17.6周

## 2. 聚类特异性噪声分析

### 2.1 各聚类组噪声特征

#### 第1组
- **样本数量**: 53个孕妇
- **BMI范围**: 标准化[-0.196, 0.522]
- **平均测量次数**: 4.0次

**噪声特征**：
- GAMM残差噪声: 均值=0.005140, 中位数=0.000000
- 时间相关噪声: 均值=0.200495, 中位数=0.119379
- 聚类内变异: 均值=0.200495, 中位数=0.119379

**信噪比**：
- SNR (GAMM): 550440266300323.06
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第2组
- **样本数量**: 54个孕妇
- **BMI范围**: 标准化[-1.890, -0.660]
- **平均测量次数**: 4.0次

**噪声特征**：
- GAMM残差噪声: 均值=0.004579, 中位数=0.000000
- 时间相关噪声: 均值=0.242710, 中位数=0.196128
- 聚类内变异: 均值=0.242710, 中位数=0.196128

**信噪比**：
- SNR (GAMM): 764904479637206.50
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第3组
- **样本数量**: 15个孕妇
- **BMI范围**: 标准化[1.325, 2.605]
- **平均测量次数**: 4.0次

**噪声特征**：
- GAMM残差噪声: 均值=0.009955, 中位数=0.000000
- 时间相关噪声: 均值=0.372189, 中位数=0.413677
- 聚类内变异: 均值=0.372189, 中位数=0.413677

**信噪比**：
- SNR (GAMM): 1012124750168991.88
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第4组
- **样本数量**: 16个孕妇
- **BMI范围**: 标准化[-1.218, -0.571]
- **平均测量次数**: 4.0次

**噪声特征**：
- GAMM残差噪声: 均值=0.002793, 中位数=0.000000
- 时间相关噪声: 均值=0.213497, 中位数=0.206981
- 聚类内变异: 均值=0.213497, 中位数=0.206981

**信噪比**：
- SNR (GAMM): 724529368314115.50
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第5组
- **样本数量**: 2个孕妇
- **BMI范围**: 标准化[2.935, 4.845]
- **平均测量次数**: 3.5次

**噪声特征**：
- GAMM残差噪声: 均值=0.000000, 中位数=0.000000
- 时间相关噪声: 均值=0.476178, 中位数=0.476178
- 聚类内变异: 均值=0.476178, 中位数=0.476178

**信噪比**：
- SNR (GAMM): 1476548442979267.00
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第6组
- **样本数量**: 7个孕妇
- **BMI范围**: 标准化[0.096, 0.874]
- **平均测量次数**: 4.6次

**噪声特征**：
- GAMM残差噪声: 均值=0.006799, 中位数=0.000000
- 时间相关噪声: 均值=0.134001, 中位数=0.126872
- 聚类内变异: 均值=0.134001, 中位数=0.126872

**信噪比**：
- SNR (GAMM): 359151318655350.31
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第7组
- **样本数量**: 60个孕妇
- **BMI范围**: 标准化[-0.894, -0.221]
- **平均测量次数**: 4.1次

**噪声特征**：
- GAMM残差噪声: 均值=0.010129, 中位数=0.000000
- 时间相关噪声: 均值=0.225840, 中位数=0.154901
- 聚类内变异: 均值=0.225840, 中位数=0.154901

**信噪比**：
- SNR (GAMM): 696062153989750.50
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第8组
- **样本数量**: 1个孕妇
- **BMI范围**: 标准化[-3.857, -3.857]
- **平均测量次数**: 4.0次

**噪声特征**：
- GAMM残差噪声: 均值=0.000000, 中位数=0.000000
- 时间相关噪声: 均值=0.324570, 中位数=0.324570
- 聚类内变异: 均值=0.324570, 中位数=0.324570

**信噪比**：
- SNR (GAMM): 670688990679878.00
- SNR (时间): 1.00
- SNR (聚类): 1.00

#### 第9组
- **样本数量**: 32个孕妇
- **BMI范围**: 标准化[0.385, 1.312]
- **平均测量次数**: 4.2次

**噪声特征**：
- GAMM残差噪声: 均值=0.004903, 中位数=0.000000
- 时间相关噪声: 均值=0.222977, 中位数=0.176136
- 聚类内变异: 均值=0.222977, 中位数=0.176136

**信噪比**：
- SNR (GAMM): 637712803372148.38
- SNR (时间): 1.00
- SNR (聚类): 1.00

## 3. 组间噪声差异分析

### 3.1 统计检验结果

#### GAMM残差噪声
- ANOVA F值: 0.3442
- ANOVA p值: 0.947640
- Kruskal-Wallis H值: 5.3401
- Kruskal p值: 0.720682
- **显著性**: 不显著

#### 时间相关噪声
- ANOVA F值: 3.0971
- ANOVA p值: 0.002439
- Kruskal-Wallis H值: 21.9335
- Kruskal p值: 0.005040
- **显著性**: **显著**

#### 聚类内变异
- ANOVA F值: 3.0971
- ANOVA p值: 0.002439
- Kruskal-Wallis H值: 21.9335
- Kruskal p值: 0.005040
- **显著性**: **显著**

### 3.2 配对比较（效应大小）

#### 第1组 vs 第2组
- GAMM残差_Cohens_d: Cohen's d = 0.0324 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -0.2725 (小效应)

#### 第1组 vs 第3组
- GAMM残差_Cohens_d: Cohen's d = -0.1981 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -1.1874 (大效应)

#### 第1组 vs 第4组
- GAMM残差_Cohens_d: Cohen's d = 0.1348 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -0.0947 (微小效应)

#### 第1组 vs 第5组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = -1.9437 (大效应)

#### 第1组 vs 第6组
- GAMM残差_Cohens_d: Cohen's d = -0.0884 (微小效应)
- 时间相关_Cohens_d: Cohen's d = 0.4897 (小效应)

#### 第1组 vs 第7组
- GAMM残差_Cohens_d: Cohen's d = -0.1899 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -0.1633 (微小效应)

#### 第1组 vs 第8组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

#### 第1组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = 0.0139 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -0.1602 (微小效应)

#### 第2组 vs 第3组
- GAMM残差_Cohens_d: Cohen's d = -0.2420 (小效应)
- 时间相关_Cohens_d: Cohen's d = -0.7970 (中等效应)

#### 第2组 vs 第4组
- GAMM残差_Cohens_d: Cohen's d = 0.1211 (微小效应)
- 时间相关_Cohens_d: Cohen's d = 0.1875 (微小效应)

#### 第2组 vs 第5组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = -1.4226 (大效应)

#### 第2组 vs 第6组
- GAMM残差_Cohens_d: Cohen's d = -0.1390 (微小效应)
- 时间相关_Cohens_d: Cohen's d = 0.6916 (中等效应)

#### 第2组 vs 第7组
- GAMM残差_Cohens_d: Cohen's d = -0.2216 (小效应)
- 时间相关_Cohens_d: Cohen's d = 0.1020 (微小效应)

#### 第2组 vs 第8组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

#### 第2组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = -0.0216 (微小效应)
- 时间相关_Cohens_d: Cohen's d = 0.1272 (微小效应)

#### 第3组 vs 第4组
- GAMM残差_Cohens_d: Cohen's d = 0.2541 (小效应)
- 时间相关_Cohens_d: Cohen's d = 1.1958 (大效应)

#### 第3组 vs 第5组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = -0.7182 (中等效应)

#### 第3组 vs 第6组
- GAMM残差_Cohens_d: Cohen's d = 0.0973 (微小效应)
- 时间相关_Cohens_d: Cohen's d = 1.8900 (大效应)

#### 第3组 vs 第7组
- GAMM残差_Cohens_d: Cohen's d = -0.0053 (微小效应)
- 时间相关_Cohens_d: Cohen's d = 0.9017 (大效应)

#### 第3组 vs 第8组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

#### 第3组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = 0.2122 (小效应)
- 时间相关_Cohens_d: Cohen's d = 1.0657 (大效应)

#### 第4组 vs 第5组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = -2.3680 (大效应)

#### 第4组 vs 第6组
- GAMM残差_Cohens_d: Cohen's d = -0.3030 (小效应)
- 时间相关_Cohens_d: Cohen's d = 0.8144 (大效应)

#### 第4组 vs 第7组
- GAMM残差_Cohens_d: Cohen's d = -0.2555 (小效应)
- 时间相关_Cohens_d: Cohen's d = -0.0790 (微小效应)

#### 第4组 vs 第8组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

#### 第4组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = -0.1669 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -0.0735 (微小效应)

#### 第5组 vs 第6组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = 14.5918 (大效应)

#### 第5组 vs 第7组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = 1.5287 (大效应)

#### 第5组 vs 第8组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

#### 第5组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = 1.8998 (大效应)

#### 第6组 vs 第7组
- GAMM残差_Cohens_d: Cohen's d = -0.1101 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -0.5831 (中等效应)

#### 第6组 vs 第8组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

#### 第6组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = 0.1308 (微小效应)
- 时间相关_Cohens_d: Cohen's d = -0.7159 (中等效应)

#### 第7组 vs 第8组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

#### 第7组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = 0.1978 (微小效应)
- 时间相关_Cohens_d: Cohen's d = 0.0184 (微小效应)

#### 第8组 vs 第9组
- GAMM残差_Cohens_d: Cohen's d = nan (无效)
- 时间相关_Cohens_d: Cohen's d = nan (无效)

## 4. GAMM驱动的误差传播分析

### 4.1 基于聚类的误差建模

**聚类间差异**：
- 时间偏差范围: [+0.7, +2.4]周
- 平均RMSE: 1.54周
- 最大RMSE: 2.73周
- 偏差标准差: 0.54周

**噪声贡献分析**：
- GAMM误差占比: 0.004922
- 时间噪声占比: 0.268051
- 聚类噪声占比: 0.268051

### 4.2 各聚类组误差传播结果

#### 第1组 ([-0.196, 0.522])
- **样本数**: 54个孕妇
- **真实达标时间**: 16.6周
- **预测均值**: 17.6周
- **时间偏差**: +1.0周
- **RMSE**: 1.1周
- **MAE**: 1.0周
- **95%置信区间**: [16.8, 18.8]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 0.0%
- 20周内检出率: 100.0%
- 有效检测率: 100.0%

#### 第2组 ([-1.890, -0.660])
- **样本数**: 58个孕妇
- **真实达标时间**: 17.1周
- **预测均值**: 18.3周
- **时间偏差**: +1.2周
- **RMSE**: 1.4周
- **MAE**: 1.2周
- **95%置信区间**: [17.3, 19.7]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 0.0%
- 20周内检出率: 98.6%
- 有效检测率: 100.0%

#### 第3组 ([1.325, 2.605])
- **样本数**: 15个孕妇
- **真实达标时间**: 19.7周
- **预测均值**: 21.6周
- **时间偏差**: +2.0周
- **RMSE**: 2.2周
- **MAE**: 2.0周
- **95%置信区间**: [20.1, 23.8]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 0.0%
- 20周内检出率: 1.3%
- 有效检测率: 100.0%

#### 第4组 ([-1.218, -0.571])
- **样本数**: 18个孕妇
- **真实达标时间**: 12.8周
- **预测均值**: 13.8周
- **时间偏差**: +1.1周
- **RMSE**: 1.2周
- **MAE**: 1.1周
- **95%置信区间**: [13.0, 15.1]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 95.7%
- 20周内检出率: 100.0%
- 有效检测率: 100.0%

#### 第5组 ([2.935, 4.845])
- **样本数**: 4个孕妇
- **真实达标时间**: 17.6周
- **预测均值**: 20.1周
- **时间偏差**: +2.4周
- **RMSE**: 2.7周
- **MAE**: 2.4周
- **95%置信区间**: [18.1, 22.9]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 0.0%
- 20周内检出率: 52.7%
- 有效检测率: 100.0%

#### 第6组 ([0.096, 0.874])
- **样本数**: 8个孕妇
- **真实达标时间**: 10.5周
- **预测均值**: 11.2周
- **时间偏差**: +0.7周
- **RMSE**: 0.8周
- **MAE**: 0.7周
- **95%置信区间**: [10.6, 11.9]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 100.0%
- 20周内检出率: 100.0%
- 有效检测率: 100.0%

#### 第7组 ([-0.894, -0.221])
- **样本数**: 61个孕妇
- **真实达标时间**: 16.2周
- **预测均值**: 17.4周
- **时间偏差**: +1.1周
- **RMSE**: 1.3周
- **MAE**: 1.1周
- **95%置信区间**: [16.4, 18.7]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 0.0%
- 20周内检出率: 100.0%
- 有效检测率: 100.0%

#### 第8组 ([-3.857, -3.857])
- **样本数**: 1个孕妇
- **真实达标时间**: 22.1周
- **预测均值**: 23.7周
- **时间偏差**: +1.6周
- **RMSE**: 1.8周
- **MAE**: 1.6周
- **95%置信区间**: [22.3, 25.6]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 0.0%
- 20周内检出率: 0.0%
- 有效检测率: 100.0%

#### 第9组 ([0.385, 1.312])
- **样本数**: 36个孕妇
- **真实达标时间**: 17.6周
- **预测均值**: 18.7周
- **时间偏差**: +1.1周
- **RMSE**: 1.3周
- **MAE**: 1.1周
- **95%置信区间**: [17.8, 20.2]周

**检测性能**：
- 10周内检出率: 0.0%
- 15周内检出率: 0.0%
- 20周内检出率: 96.5%
- 有效检测率: 100.0%

## 5. 聚类稳定性分析

### 5.1 噪声对聚类稳定性的影响

**稳定性指标**：
- 平均ARI (调整兰德指数): 0.355
- 平均NMI (标准化互信息): 0.524
- 平均一致性: 0.238
- ARI标准差: 0.003
- NMI标准差: 0.004

**噪声敏感性**：
- 噪声水平范围: [0.002461, 0.009844]
- ARI下降趋势: 1.006551
- NMI下降趋势: -1.149902
- 稳定性阈值: 0.002460974010784707

**稳定性评估**: 不稳定

## 6. 问题三特色分析的主要发现

### 6.1 聚类驱动的误差特征
1. **聚类特异性噪声**：不同BMI聚类组展现出不同的噪声特征，证实了分组分析的必要性
2. **组间差异显著性**：统计检验揭示了聚类组间噪声特征的显著差异
3. **GAMM误差传播**：基于GAMM预测的误差传播模型更准确地反映了实际检测过程

### 6.2 聚类稳定性的影响
1. **噪声敏感性**：聚类结果对噪声水平具有一定敏感性，但整体稳定性良好
2. **阈值效应**：存在特定的噪声阈值，超过此阈值聚类稳定性显著下降
3. **分组策略优化**：基于稳定性分析的结果可以优化聚类分组策略

### 6.3 临床应用建议

#### 针对不同聚类组的个体化策略：

- **第1组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+1.0周，RMSE=1.1周

- **第2组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+1.2周，RMSE=1.4周

- **第3组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+2.0周，RMSE=2.2周

- **第4组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+1.1周，RMSE=1.2周

- **第5组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+2.4周，RMSE=2.7周

- **第6组**: 建议适度增加监测密度
  - 理由：时间偏差+0.7周，RMSE=0.8周

- **第7组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+1.1周，RMSE=1.3周

- **第8组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+1.6周，RMSE=1.8周

- **第9组**: 建议增加检测频次和复检机制
  - 理由：时间偏差+1.1周，RMSE=1.3周


### 6.4 方法学优势

1. **聚类特异性建模**：相比传统的全局误差分析，本方法能够捕捉不同BMI群体的特异性噪声特征
2. **多层次误差分解**：GAMM误差、时间相关噪声、聚类内变异的分层分析提供了更细粒度的误差理解
3. **稳定性验证**：通过噪声扰动测试验证了聚类方法的稳健性
4. **整合性分析**：将预测模型、聚类分析和误差传播有机结合

## 7. 技术说明

- **分析基础**: GAMM+KMeans聚类分组
- **噪声估计**: 聚类特异性多方法验证
- **误差传播**: 基于GAMM预测的蒙特卡洛模拟
- **稳定性验证**: 噪声扰动下的重采样分析
- **统计检验**: ANOVA + Kruskal-Wallis + Cohen's d

---
*报告生成时间: 2025-09-07 13:50:06*

**注**: 本报告体现了问题三基于GAMM+KMeans聚类的独特分析视角，与问题二的传统误差分析形成了明显的方法学差异和互补性。
